<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Arnaud Dionne</title>
    <link rel="icon" href="data:," />
    <style>
      :root {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        color: #1f2933;
        background: #f8fafc;
        line-height: 1.6;
      }

      body {
        margin: 0;
        padding: 0 1.5rem 2rem;
      }

      header,
      main,
      footer {
        max-width: 60rem;
        margin: 0 auto;
      }

      header {
        padding: 3rem 0 1rem;
      }

      h1 {
        font-size: clamp(2.5rem, 4vw, 3rem);
        margin: 0;
      }

      nav {
        margin-top: 1rem;
      }

      nav a {
        display: inline-block;
        margin-right: 1rem;
        text-decoration: none;
        color: #2563eb;
      }

      nav a:hover {
        text-decoration: underline;
      }

      section {
        margin-top: 2rem;
      }

      .spotify-card {
        display: grid;
        grid-template-columns: 96px 1fr;
        gap: 1rem;
        padding: 1rem;
        border: 1px solid #d2d6dc;
        border-radius: 12px;
        background: #ffffff;
        box-shadow: 0 12px 24px rgba(15, 23, 42, 0.08);
        opacity: 0;
        transform: translateY(32px);
      }

      .spotify-card img {
        width: 96px;
        height: 96px;
        object-fit: cover;
        border-radius: 8px;
      }

      .spotify-card h3 {
        margin: 0 0 0.25rem;
      }

      button {
        border: none;
        background: #2563eb;
        color: #ffffff;
        padding: 0.65rem 1.25rem;
        border-radius: 999px;
        font-weight: 600;
        cursor: pointer;
        transition: transform 200ms ease, box-shadow 200ms ease;
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 18px rgba(37, 99, 235, 0.25);
      }

      footer {
        margin-top: 4rem;
        padding-top: 1rem;
        border-top: 1px solid #d2d6dc;
        font-size: 0.875rem;
        color: #52606d;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>Arnaud Dionne</h1>
      <p>Welcome! This page is a clean slate so you can practice writing raw HTML and CSS.</p>

      <nav>
        <a href="#about">About</a>
        <a href="#projects">Projects</a>
        <a href="#contact">Contact</a>
      </nav>
    </header>

    <main>
      <section id="about">
        <h2>About</h2>
        <p>
          Replace this text with your story. You can add lists, images, or even experiment with layout by editing the HTML
          and CSS in this file.
        </p>
      </section>

      <section id="projects">
        <h2>Projects</h2>
        <p>
          Showcase what you are working on. Add cards, grids, or custom components to get more hands-on HTML practice.
        </p>
      </section>

      <section id="spotify">
        <h2>Spotify Now Playing</h2>
        <p>
          This section calls a tiny serverless API (hosted on Vercel) that keeps Spotify tokens safe, then returns lightweight
          JSON for the browser to render. Follow the instructions in the script comments to set up your own endpoint.
        </p>
        <button id="load-spotify">Check now playing</button>
        <article id="spotify-card" class="spotify-card" hidden aria-live="polite">
          <img id="spotify-artwork" alt="Album artwork" src="" />
          <div>
            <h3 id="spotify-track">Track title</h3>
            <p id="spotify-artist" style="margin: 0;">Artist name</p>
            <p id="spotify-context" style="margin: 0.25rem 0 0; font-size: 0.95rem; color: #334155;"></p>
            <p id="spotify-status" style="margin: 0.75rem 0 0; font-size: 0.875rem; color: #52606d;"></p>
          </div>
        </article>
        <p id="spotify-error" style="display: none; color: #b91c1c; margin-top: 1rem;"></p>
      </section>

      <section id="contact">
        <h2>Contact</h2>
        <p>
          Provide your email or links to social profiles. You can also embed a form or other interactive elements here.
        </p>
      </section>
    </main>

    <footer>
      <p>Copyright &copy; <span id="year"></span> Arnaud Dionne. Built by hand with vanilla HTML and CSS.</p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js" integrity="sha512-n9jNwyqamBxJG+pI5YPzBWMtwL4zCwRwPFQokWcU3PHrWwIu/8A1UFvsSNAK4N59k2MSw6RJWC85MtUbI7AjJQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
      // Keep footer year current without extra maintenance.
      document.getElementById("year").textContent = new Date().getFullYear();

      // --- Spotify API integration -----------------------------------------------------------
      // This frontend calls a serverless endpoint (e.g. https://your-app.vercel.app/api/now-playing)
      // that holds Spotify credentials and returns sanitized JSON like:
      // {
      //   isPlaying: true,
      //   progressMs: 12345,
      //   track: { name, album, artists, albumImageUrl, trackUrl },
      //   context: { type, name },
      //   lastUpdated: "2024-01-01T12:00:00.000Z"
      // }
      //
      // Steps to make it work:
      // 1. Implement the Vercel serverless function described below and deploy it.
      // 2. Update API_URL to point to your live deployment.
      // 3. (Optional) Add caching headers on the function to avoid rate limits.

      const API_URL = "https://your-vercel-app.vercel.app/api/now-playing";
      const loadButton = document.getElementById("load-spotify");
      const errorEl = document.getElementById("spotify-error");
      const card = document.getElementById("spotify-card");
      const artwork = document.getElementById("spotify-artwork");
      const trackTitle = document.getElementById("spotify-track");
      const artist = document.getElementById("spotify-artist");
      const context = document.getElementById("spotify-context");
      const status = document.getElementById("spotify-status");

      function showError(message) {
        errorEl.textContent = message;
        errorEl.style.display = "block";
        card.hidden = true;
      }

      async function fetchSpotifyTrack() {
        errorEl.style.display = "none";
        loadButton.disabled = true;
        loadButton.textContent = "Loading...";
        try {
          const response = await fetch(API_URL, { cache: "no-store" });
          if (!response.ok) {
            throw new Error(`Request failed: ${response.status} ${response.statusText}`);
          }

          const payload = await response.json();

          if (!payload || !payload.track) {
            showError("No now playing data returned. Try again in a moment.");
            return;
          }

          const { track, context: ctx, isPlaying, lastUpdated } = payload;

          trackTitle.innerHTML = track.trackUrl
            ? `<a href="${track.trackUrl}" target="_blank" rel="noopener">${track.name}</a>`
            : track.name;
          artist.textContent = track.artists.join(", ");
          context.textContent = ctx?.name ? `${ctx.type}: ${ctx.name}` : track.album;
          status.textContent = isPlaying
            ? "Currently playing"
            : `Last played at ${new Date(lastUpdated).toLocaleTimeString()}`;
          artwork.src = track.albumImageUrl || "";
          artwork.alt = track.album ? `${track.album} cover` : "Album artwork";

          card.hidden = false;

          // Trigger the GSAP entry animation when fresh data loads.
          gsap.fromTo(
            card,
            { opacity: 0, y: 32 },
            { opacity: 1, y: 0, duration: 1, ease: "power3.out" }
          );
        } catch (error) {
          console.error(error);
          showError("Unable to load Spotify data. Check the console or API deployment.");
        }
        loadButton.disabled = false;
        loadButton.textContent = "Check now playing";
      }

      loadButton.addEventListener("click", fetchSpotifyTrack);

      // --- Example GSAP animation ------------------------------------------------------------
      // Animate the hero elements on page load to demonstrate timeline sequencing.
      window.addEventListener("load", () => {
        const tl = gsap.timeline({ defaults: { duration: 1, ease: "power3.out" } });

        tl.from("header h1", { y: 40, opacity: 0 })
          .from("header p", { y: 20, opacity: 0 }, "-=0.6")
          .from("nav a", { y: 10, opacity: 0, stagger: 0.1 }, "-=0.6");
      });
    </script>
  </body>
</html>
